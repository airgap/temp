CREATE TABLE IF NOT EXISTS "achievementGrants" ("id" TEXT PRIMARY KEY NOT NULL, "achievement" BIGINT NOT NULL, "user" BIGINT NOT NULL, "granted" TIMESTAMP NOT NULL, "game" INTEGER);
CREATE TABLE IF NOT EXISTS "achievements" ("description" TEXT, "id" BIGINT PRIMARY KEY NOT NULL, "icon" TEXT CHECK (length("icon") <= 100) CHECK (length("icon") >= 1) NOT NULL, "name" TEXT CHECK (length("name") <= 100) CHECK (length("name") >= 1) NOT NULL, "points" INTEGER NOT NULL, "tier" TEXT CHECK ("tier" IN ('tin', 'bronze', 'silver', 'gold', 'tritium')), "game" INTEGER);
CREATE TABLE IF NOT EXISTS "btvStats" ("user" BIGINT PRIMARY KEY, "totalTime" DOUBLE PRECISION NOT NULL, "totalEdges" BIGINT CHECK ("totalEdges" >= 0) NOT NULL, "totalCorners" BIGINT CHECK ("totalCorners" >= 0) NOT NULL, "currentTime" DOUBLE PRECISION NOT NULL, "currentEdges" BIGINT CHECK ("currentEdges" >= 0) NOT NULL, "currentCorners" BIGINT CHECK ("currentCorners" >= 0) NOT NULL, "highestTime" DOUBLE PRECISION NOT NULL, "highestEdges" BIGINT CHECK ("highestEdges" >= 0) NOT NULL, "highestCorners" BIGINT CHECK ("highestCorners" >= 0) NOT NULL, "sessionCount" BIGINT CHECK ("sessionCount" >= 0) NOT NULL);
CREATE TABLE IF NOT EXISTS "channelSensitives" ("id" BIGINT PRIMARY KEY NOT NULL, "owner" BIGINT NOT NULL, "inputId" TEXT NOT NULL, "rtmpsKey" TEXT NOT NULL, "srtUrl" TEXT NOT NULL, "whipUrl" TEXT NOT NULL);
CREATE TABLE IF NOT EXISTS "channels" ("live" BOOLEAN NOT NULL, "fgColor" CHAR(6), "bgColor" CHAR(6), "tvColor" CHAR(6), "id" BIGSERIAL PRIMARY KEY NOT NULL, "owner" BIGINT NOT NULL, "logo" VARCHAR CHECK (length("logo") <= 50) CHECK (length("logo") >= 5), "created" TIMESTAMP NOT NULL, "name" VARCHAR CHECK (length("name") <= 30) CHECK (length("name") >= 3) NOT NULL, "slug" VARCHAR CHECK (length("slug") <= 30) CHECK (length("slug") >= 3) NOT NULL, "tagline" VARCHAR CHECK (length("tagline") <= 255), "bio" VARCHAR CHECK (length("bio") <= 1024), "activeBg" VARCHAR CHECK (length("activeBg") <= 50) CHECK (length("activeBg") >= 5), "awayBg" VARCHAR CHECK (length("awayBg") <= 50) CHECK (length("awayBg") >= 5), "totalStreamTime" DOUBLE PRECISION, "whepKey" VARCHAR CHECK (length("whepKey") <= 50) CHECK (length("whepKey") >= 5));
CREATE TABLE IF NOT EXISTS "developers" ("id" BIGINT PRIMARY KEY NOT NULL, "homepage" TEXT NOT NULL, "name" TEXT CHECK (length("name") <= 100) NOT NULL, "thumbnail" TEXT);
CREATE TABLE IF NOT EXISTS "friendLists" ("user" BIGINT PRIMARY KEY NOT NULL, "friends" BIGINT[] NOT NULL, "count" INTEGER NOT NULL);
CREATE TABLE IF NOT EXISTS "friendRequests" ("created" TIMESTAMP NOT NULL, "from" BIGINT NOT NULL, "id" TEXT PRIMARY KEY NOT NULL, "to" BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS "friendships" ("created" TIMESTAMP NOT NULL, "id" TEXT PRIMARY KEY NOT NULL, "users" BIGINT[] CHECK (array_length("users", 1) >= 2) CHECK (array_length("users", 1) <= 2) NOT NULL);
CREATE TABLE IF NOT EXISTS "games" ("background" TEXT, "developer" TEXT, "homepage" TEXT, "icon" TEXT, "id" INTEGER PRIMARY KEY NOT NULL, "publisher" TEXT, "thumbnail" TEXT, "title" TEXT NOT NULL, "description" TEXT, "status" TEXT CHECK ("status" IN ('ga', 'wip', 'maintenance', 'ea', 'planned')) NOT NULL, "nsfw" BOOLEAN NOT NULL);
CREATE TABLE IF NOT EXISTS "groupMemberships" ("id" TEXT PRIMARY KEY NOT NULL, "group" BIGINT NOT NULL, "user" BIGINT NOT NULL, "created" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "groups" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "slug" VARCHAR CHECK (length("slug") <= 20) NOT NULL, "lowerSlug" VARCHAR CHECK (length("lowerSlug") <= 20) NOT NULL, "name" VARCHAR CHECK (length("name") <= 30) NOT NULL, "creator" BIGINT NOT NULL, "owner" BIGINT NOT NULL, "created" TIMESTAMP NOT NULL, "private" BOOLEAN NOT NULL, "thumbnail" VARCHAR CHECK (length("thumbnail") <= 30), "background" VARCHAR CHECK (length("background") <= 30));
CREATE TABLE IF NOT EXISTS "hashtagUsages" ("id" BIGINT PRIMARY KEY NOT NULL, "hashtag" BIGINT NOT NULL, "post" BIGINT NOT NULL, "group" BIGINT, "originalText" TEXT NOT NULL, "lowerText" TEXT NOT NULL, "created" TIMESTAMP NOT NULL, "author" BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS "hashtags" ("id" BIGINT PRIMARY KEY NOT NULL, "lowerText" TEXT NOT NULL);
CREATE TABLE IF NOT EXISTS "imageDrafts" ("user" BIGINT NOT NULL, "channel" BIGINT, "post" BIGINT, "reason" TEXT CHECK ("reason" IN ('PostAttachment', 'ChannelLogo', 'ProfilePicture', 'ActiveChannelBackground', 'AwayChannelBackground')) NOT NULL, "id" BIGINT PRIMARY KEY NOT NULL, "uploadURL" TEXT NOT NULL, "created" TIMESTAMP NOT NULL, "filename" TEXT CHECK (length("filename") <= 100));
CREATE TABLE IF NOT EXISTS "images" ("id" BIGINT PRIMARY KEY NOT NULL, "uploaded" TEXT NOT NULL, "requireSignedURLs" BOOLEAN NOT NULL, "variants" TEXT[] NOT NULL, "draft" BOOLEAN, "channel" TEXT);
CREATE TABLE IF NOT EXISTS "leaderboards" ("game" BIGINT NOT NULL, "owner" BIGINT NOT NULL, "id" BIGSERIAL PRIMARY KEY NOT NULL, "creator" BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS "likes" ("id" TEXT PRIMARY KEY NOT NULL, "userId" BIGINT NOT NULL, "postId" BIGINT NOT NULL, "created" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "logins" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "userId" BIGINT NOT NULL, "ip" TEXT NOT NULL, "created" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "matchProposals" ("created" TIMESTAMP NOT NULL, "from" BIGINT NOT NULL, "game" INTEGER NOT NULL, "id" BIGSERIAL PRIMARY KEY NOT NULL, "to" BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS "membershipLists" ("user" BIGINT PRIMARY KEY NOT NULL, "groups" BIGINT[] NOT NULL, "count" INTEGER NOT NULL);
CREATE TABLE IF NOT EXISTS "messages" ("author" BIGINT NOT NULL, "content" VARCHAR CHECK (length("content") <= 300) CHECK (length("content") >= 1) NOT NULL, "channel" BIGINT NOT NULL, "created" TIMESTAMP NOT NULL, "id" BIGSERIAL PRIMARY KEY NOT NULL);
CREATE TABLE IF NOT EXISTS "notifications" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "user" BIGINT NOT NULL, "title" VARCHAR CHECK (length("title") <= 50) CHECK (length("title") >= 5) NOT NULL, "subtitle" VARCHAR CHECK (length("subtitle") <= 50) CHECK (length("subtitle") >= 5), "body" TEXT CHECK (length("body") <= 1000) NOT NULL, "icon" VARCHAR CHECK (length("icon") <= 50) CHECK (length("icon") >= 5) NOT NULL, "href" VARCHAR CHECK (length("href") <= 50) CHECK (length("href") >= 5), "posted" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "postDrafts" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "author" BIGINT NOT NULL, "body" TEXT CHECK (length("body") <= 1337) CHECK (length("body") >= 1), "replyTo" BIGINT, "echoing" BIGINT, "attachments" BIGINT[]);
CREATE TABLE IF NOT EXISTS "posts" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "body" TEXT CHECK (length("body") <= 1337) CHECK (length("body") >= 1), "bodyType" TEXT CHECK ("bodyType" IN ('plaintext', 'markdown')), "echoes" BIGINT NOT NULL, "group" BIGINT, "hashtags" BIGINT[], "author" BIGINT NOT NULL, "likes" BIGINT NOT NULL, "loves" BIGINT, "published" TIMESTAMP NOT NULL, "replies" BIGINT NOT NULL, "title" VARCHAR CHECK (length("title") <= 100) CHECK (length("title") >= 1), "thread" BIGINT[], "shortcode" VARCHAR CHECK (length("shortcode") <= 22), "replyTo" BIGINT, "echoing" BIGINT, "attachments" BIGINT[] CHECK (array_length("attachments", 1) <= 256));
CREATE TABLE IF NOT EXISTS "publishers" ("id" BIGINT PRIMARY KEY NOT NULL, "homepage" TEXT CHECK (length("homepage") <= 50) CHECK (length("homepage") >= 1) NOT NULL, "name" TEXT CHECK (length("name") <= 50) CHECK (length("name") >= 1) NOT NULL);
CREATE TABLE IF NOT EXISTS "scores" ("id" BIGSERIAL PRIMARY KEY, "posted" TIMESTAMP NOT NULL, "user" BIGINT NOT NULL, "channel" BIGINT NOT NULL, "reports" INTEGER NOT NULL, "columns" BIGINT[] NOT NULL, "leaderboard" BIGINT NOT NULL, "game" BIGINT NOT NULL);
CREATE TABLE IF NOT EXISTS "sessions" ("id" CHAR(44) PRIMARY KEY NOT NULL, "userId" BIGINT NOT NULL, "ip" TEXT NOT NULL, "created" TIMESTAMP NOT NULL, "expiration" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "shortlinks" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "url" TEXT CHECK (length("url") <= 255) NOT NULL, "author" BIGINT, "post" BIGINT);
CREATE TABLE IF NOT EXISTS "ttfMatches" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "X" BIGINT NOT NULL, "O" BIGINT NOT NULL, "board" CHAR(10) NOT NULL, "turn" INTEGER NOT NULL, "whoseTurn" BIGINT, "created" TIMESTAMP NOT NULL, "lastTurn" TIMESTAMP, "winner" BIGINT);
CREATE TABLE IF NOT EXISTS "ttmMatches" ("id" BIGSERIAL PRIMARY KEY NOT NULL, "X" BIGINT NOT NULL, "O" BIGINT NOT NULL, "board" CHAR(25) NOT NULL, "turn" INTEGER NOT NULL, "created" TIMESTAMP NOT NULL, "lastTurn" TIMESTAMP, "winner" BIGINT);
CREATE TABLE IF NOT EXISTS "userFollows" ("follower" BIGINT NOT NULL, "followee" BIGINT NOT NULL, "id" TEXT PRIMARY KEY NOT NULL, "created" TIMESTAMP NOT NULL);
CREATE TABLE IF NOT EXISTS "userHashes" ("email" TEXT CHECK (length("email") <= 50) NOT NULL, "hash" TEXT CHECK (length("hash") <= 50) NOT NULL, "id" BIGINT PRIMARY KEY NOT NULL);
CREATE TABLE IF NOT EXISTS "users" ("banned" BOOLEAN NOT NULL, "confirmed" BOOLEAN NOT NULL, "bot" BOOLEAN NOT NULL, "groupLimit" INTEGER CHECK ("groupLimit" >= 0) NOT NULL, "chatColor" CHAR(6) NOT NULL, "id" BIGSERIAL PRIMARY KEY NOT NULL, "joined" TIMESTAMP NOT NULL, "live" BOOLEAN NOT NULL, "profilePicture" TEXT, "staff" BOOLEAN NOT NULL, "username" VARCHAR UNIQUE CHECK (length("username") <= 20) NOT NULL, "channelLimit" INTEGER, "slug" TEXT CHECK (length("slug") <= 20) CHECK (length("slug") >= 2) NOT NULL, "points" BIGINT NOT NULL, "postCount" BIGINT NOT NULL, "lastLogin" TIMESTAMP NOT NULL, "lastSuper" TIMESTAMP NOT NULL, "owner" BIGINT, "name" TEXT CHECK (length("name") <= 30) CHECK (length("name") >= 3));
CREATE TABLE IF NOT EXISTS "videoDrafts" ("user" BIGINT NOT NULL, "channel" BIGINT, "post" BIGINT NOT NULL, "id" BIGINT PRIMARY KEY NOT NULL, "uid" TEXT CHECK (length("uid") <= 32) NOT NULL, "uploadURL" TEXT NOT NULL, "created" TIMESTAMP NOT NULL, "filename" TEXT CHECK (length("filename") <= 100));
CREATE TABLE IF NOT EXISTS "videos" ("id" BIGINT PRIMARY KEY NOT NULL, "allowedOrigins" TEXT[] NOT NULL, "created" TIMESTAMP NOT NULL, "duration" DOUBLE PRECISION NOT NULL, "width" INTEGER NOT NULL, "height" INTEGER NOT NULL, "modified" TIMESTAMP NOT NULL, "preview" TEXT NOT NULL, "readyToStream" BOOLEAN NOT NULL, "requireSignedURLs" BOOLEAN NOT NULL, "size" INTEGER NOT NULL, "state" TEXT NOT NULL, "pctComplete" TEXT NOT NULL, "errorReasonCode" TEXT NOT NULL, "errorReasonText" TEXT NOT NULL, "thumbnail" TEXT NOT NULL, "thumbnailTimestampPct" DOUBLE PRECISION NOT NULL, "creator" TEXT NOT NULL, "uploaded" TIMESTAMP NOT NULL, "uid" VARCHAR CHECK (length("uid") <= 32) NOT NULL, "author" BIGINT NOT NULL, "post" BIGINT);
